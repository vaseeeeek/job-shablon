{strip}
<script src="{$wa_theme_url}cart.js"></script>

{$default_img = "`$wa_theme_url`img/dummy48.png"}
{if !empty($theme_settings.default_img)}
    {$default_img = "`$wa_parent_theme_url``$theme_settings.default_img`"}
{/if}

{if $wa->get('ajax')}
    {include file="popup.cart.html" inline}
{else if $wa->get('fixed')}
    {include file="fixed.cart.html" inline}
{else}
    {$cols = 1} {$sb_left = 0} {$is_sidebar_right = 0}
    {if $theme_settings.cart_sidebar_left && !$wa->isMobile()}
        {$cols = $cols + 1}
        {$sb_left = 1}
    {/if}
    {if $theme_settings.cart_sidebar_right && !$wa->isMobile()}
        {$cols = $cols + 1}
        {$is_sidebar_right = 1}
    {/if}

    <div class="cols-{$cols}">
        <div class="out_sidebars">
            {if $sb_left}
                {include file='sidebar-left.html'}
            {/if}
            {if $is_sidebar_right}
                {include file='sidebar-right.html'}
            {/if}
        </div>
        <div class="js-content content {if $sb_left} with-sidebar{/if} ">
            <div class="content-block">
                {if !$cart.count}
                    <div class="cart your-cart-is-empty">
                        <h1>[`Shopping cart`]</h1>
                        <p>[`Your shopping cart is empty.`]</p>
                    </div>
                {else}
                    <form method="post">

                        <h1>[`Shopping cart`]</h1>

                        <!-- sixteen-column cart layout -->
                        <div class="cart cart-summary-page">
                            {foreach $cart.items as $item}
                                <!-- cart item -->
                                <div class="row" data-id="{$item.id}">
                                    <div class="col cart-item_thumb">
                                        <a href="{$wa->shop->productUrl($item.product)}" title="{$item.product.name|escape}">
                                            {$wa->shop->productImgHtml($item.product, '70', ['default' => $default_img])}
                                        </a>&nbsp;
                                    </div>
                                    <div class="col cart-item_desc">
                                        <a href="{$wa->shop->productUrl($item.product)}">{$item.product.name|escape}</a>
                                        {if isset($item.sku_name) && strlen($item.sku_name) && $item.sku_name != $item.product.name}
                                            <span class="cart-item_sku bg-sdColor">{$item.sku_name|escape}</span>
                                        {/if}

                                        {if !empty($item.services)}
                                            <div class="col cart-item_services js-cart-services">
                                                {foreach $item.services as $service_id => $s}
                                                    <div class="js-cart-service" {if !empty($s.id)}data-id="{$s.id}"{/if}>
                                                        <label>
                                                            <input {if !empty($s.id)}checked{/if} type="checkbox" name="services[{$item.id}][]" value="{$service_id}"> {$s.name|escape} {if $s.price && !isset($s.variants)}(<span>+{shop_currency_html($s.price, $s.currency)}</span>){/if}
                                                        </label>
                                                        {if isset($s.variants)}
                                                            <select name="service-choice[{$item.id}][{$service_id}]" {if empty($s.id)}disabled{/if}>
                                                                {foreach $s.variants as $variant_id => $v}
                                                                    <option {if $s.variant_id == $variant_id}selected{/if} value="{$variant_id}">{$v.name|escape} (+{shop_currency($v.price, $s.currency)})</option>
                                                                {/foreach}
                                                            </select>
                                                        {else}
                                                            <input type="hidden" name="service-choice[{$item.id}][{$service_id}]" value="{$s.variant_id}">
                                                        {/if}
                                                    </div>
                                                {/foreach}
                                            </div>
                                        {/if}
                                    </div>

                                    <div class="col cart-item_right">
                                        <div class="col nowrap cart-item_qty">
                                            <span class="js-qty Cart__Qty align-center nowrap">
                                                <span data-type="-" class="js-qty-button Cart__Qty_act sdColor">-</span>
                                                <input type="text" name="quantity[{$item.id}]" value="{$item.quantity}" class="js-number qty{if !empty($item.error)} error{/if}">
                                                <span data-type="+" class="js-qty-button Cart__Qty_act sdColor">+</span>
                                            </span>
                                        </div>

                                        <div data-zero-text="{$theme_settings.text_zero_price}" class="col js-item-total cart-item_price nowrap">
                                            {if empty($item.full_price) && !empty($theme_settings.text_zero_price)}
                                                {$theme_settings.text_zero_price}
                                            {else}
                                                {shop_currency_html($item.full_price, true)}
                                            {/if}
                                        </div>

                                        <div class="col cart-item_remove">
                                            <i class="fa fa-minus-circle icon js-cart-delete"></i>
                                        </div>
                                    </div>
                                </div>
                                {if !empty($item.error)}<script>alert({json_encode($item.error)});</script>{/if}
                            {/foreach}

                            <!-- discount -->
                            <div class="row cart-item_discount" {if !shopDiscounts::isEnabled('coupons') && !$discount}style="display:none"{/if} id="discount-row">
                                <div class="col cart-item_coupon">
                                    {if !$coupon_code}<a href="#" class="inline-link" id="use-coupon">[`I have a coupon!`]</a>{/if}
                                    {if shopDiscounts::isEnabled('coupons')}
                                        <div {if !$coupon_code}style="display: none;"{/if} class="cart-coupon-form" id="apply-coupon-code">

                                            <input placeholder="[`Coupon code`]" type="text" name="coupon_code" value="{$coupon_code|escape}">
                                            <span class="cart-coupon-btn fa fa-check js-submit-form sdColor"></span>
                                            {if $coupon_code && empty($coupon_discount) && empty($coupon_free_shipping)}
                                                <div class="errormsg">[`Invalid coupon code`]</div>
                                            {/if}
                                        </div>
                                    {/if}
                                </div>
                                <div class="col cart-item_right">
                                    <div class="col cart-item_qty">[`Discount`]</div>
                                    <div class="col cart-discount nowrap cart-item_price">&minus; {shop_currency_html($discount, true)}</div>
                                </div>

                            </div>

                            {if shopAffiliate::isEnabled() && $affiliate_bonus > 0}
                            <!-- affiliate bonus -->
                            <div class="row">
                                <div class="col cart-item_coupon">
                                    {sprintf('[`Your current affiliate bonus of %s points allows you to get an additonal discount of up to %s`]', $affiliate_bonus, "<span class=\"affiliate-discount-available\">{shop_currency_html($affiliate_discount)}</span>")}
                                    {if $use_affiliate}
                                        <span class="inline-link" id="cancel-affiliate">[`Donâ€™t use bonus discount`]</span>
                                    {else}
                                        <span class="inline-link" id="use-affiliate" >[`Use bonus`]</span>
                                    {/if}
                                </div>
                                <div class="col cart-item_right">
                                    <div class="col cart-item_qty"></div>
                                    <div class="col cart-item_price affiliate-discount"{if $use_affiliate} data-use="1"{/if}>&minus; {if $use_affiliate}{shop_currency_html(shopAffiliate::convertBonus($used_affiliate_bonus))}{else}0{/if}</div>
                                </div>
                            </div>
                            {/if}

                            <!-- TOTAL -->
                            <div class="cart-total-wrap box-hlighted">
                                <span class="cart-total-text">[`Total`]</span>
                                <span class="cart-total nowrap price">{shop_currency_html($cart.total, true)}</span>
                                <div class="cart-total-btn">
                                    <!-- plugin hook: 'frontend_cart' -->
                                    {* @event frontend_cart.%plugin_id% *}
                                    {foreach $frontend_cart as $_}{$_}{/foreach}

                                    {$_storequickorder =  class_exists('shopStorequickorderPlugin') && $theme_settings.fastorder == "storequickorder"}
                                    {$_skoneclick = class_exists('shopSkoneclickHelper') && $theme_settings.fastorder == "skoneclick" && shopSkoneclickHelper::isActive()}
                                    {$_buy1click = class_exists('shopBuy1clickViewHelper') && $theme_settings.fastorder == "buy1click"}
                                    {if $_skoneclick}
                                        <span class="button-fastorder__sk-oneclick js-sk-oneclick-open-cart _show" data-type="cart" data-app-url="/">{$theme_settings.plugin_oneclick_button_text}</span>
                                    {else if $_buy1click}
                                        {shopBuy1clickViewHelper::getCartButton()}
                                    {else if $_storequickorder}
                                         {shopStorequickorderPlugin::cart_button()}
                                    {/if}

                                    <input name="checkout" type="submit" value="[`Proceed to checkout`]" class="button js-cart-checkout-button">
                                </div>
                            </div>

                            {if shopAffiliate::isEnabled() && !empty($add_affiliate_bonus)}
                            <div class="row no-border">
                                <p class="affiliate">
                                    <i class="fa fa-thumbs-o-up icon" aria-hidden="true"></i>
                                    {sprintf("[`This order will add <strong>+%s bonuses</strong> to  your account, which you will be able to spend on getting additional discounts later.`]", $add_affiliate_bonus)}
                                </p>
                            </div>
                            {/if}

                            <!-- CHECKOUT -->
                            <div class="featured-shipping-and-payment">
                                {*
                                    display up to 8 logos of available payment options;
                                    replace $wa->shop->payment() with $wa->shop->shipping() if you prefer shipping options logos
                                *}
                                {$availabe_options = $wa->shop->payment()}
                                {$_cnt = 0}
                                {foreach $availabe_options as $option name=options}
                                    {if $_cnt == 8}{break}{/if}
                                    {if $option.logo}
                                        <img src="{$option.logo}" alt="{$option.name}">
                                        {$_cnt = $_cnt + 1}
                                    {/if}
                                {foreachelse}
                                    &nbsp;
                                {/foreach}
                            </div>



                        </div>



                    </form>
                {/if}
            </div>

            {$related = $wa->shop->crossSelling($cart.items, 'product_id')}
            {if $theme_settings.cart_crossselling && $related}
            <section class="related">
                <div class="content-block">
                    <h3 class="product_cross-title">{sprintf('[`Customers who bought %s also bought`]', $item.product.name|escape)}:</h3>
                </div>

                {if $wa->isMobile()}
                    {include file="list-thumbs-mini.html" products=$related ulclass=""}
                {else}
                    {include file="list-thumbs.html" products=$related ulclass=""}
                {/if}
            </section>
            {/if}

        </div>
    </div>



{/if}
{/strip}