{strip}
{if !empty($products)}
    {$favorites = $wa->cookie('favorites_list')}
    {if $favorites}
        {$favorites_list = ","|explode:$favorites}
    {else}
        {$favorites_list = []}
    {/if}
    {if (!$wa->isMobile() && !empty($theme_settings.product_show_tile_features)) || ($wa->isMobile() && !empty($theme_settings.product_show_tile_mobile_features))}
        {$features = $wa->shop->features($products)}
    {/if}

    {$isPreviewProductGalleryTile = ($theme_settings.product_preview_tile_gallerytile && !$wa->isMobile())}
    {if $isPreviewProductGalleryTile}
        {$products_ids = ""}
        {foreach $products as $p}
            {if $p.id}{$products_ids[] = $p.id}{/if}
        {/foreach}
        {$size_image = '0x340'}
        {$products_images = $wa->shop->images($products_ids, $size_image)}
    {/if}
    <section class="js-owl-carousel-product product_cross__carousel">
        <div class="product_cross-title__outer">
            <h3 class="product_cross-title">{$product_list_title}</h3>
            <div class="product_cross__direction js-carousel-direction"></div>
        </div>
        <div class="products-grid-outer">
            {$is_preview_grid_mini = $wa->isMobile() && $theme_settings.product_preview_tile_mobile == 'mini_tile'}
            <div data-retina="{$wa->shop->config('enable_2x')}" class="js-preview-products products-tile{if $is_preview_grid_mini} products-grid--mini{/if}">
                <div class="owl-carousel owl-theme"{if $is_preview_grid_mini} data-type-mobile-preview="mini"{/if}>
                    {foreach $products as $p}
                        {include file="product-preview-tile.html" product=$p favorites=$favorites_list lazy_class="owl-lazy"}
                    {/foreach}
                </div>
            </div>
        </div>
    </section>
{/if}
{/strip}