{strip}
{if isset($list_id) && !empty($list_id)}
    {$current_lang = $wa->locale()}
    {if !isset($theme_settings.show_product_tile_features)}{$theme_settings.show_product_tile_features = false}{/if}
    {if !isset($theme_settings.cart_add_action )}{$theme_settings.cart_add_action  = 'move'}{/if}
    {if !isset($theme_settings.show_product_tile_mobile_features)}{$theme_settings.show_product_tile_mobile_features = false}{/if}
    {if !isset($theme_settings.product_list_price_range)}{$theme_settings.product_list_price_range = false}{/if}
    {if !isset($theme_settings.favorites_products)}{$theme_settings.favorites_products = true}{/if}
    {if !isset($theme_settings.compare_products)}{$theme_settings.compare_products = true}{/if}
    {if $wa_app != 'shop' || !isset($theme_settings.product_preview_dialog)}{$theme_settings.product_preview_dialog = ($wa_app == 'shop')}{/if}
    {if !isset($theme_settings.show_preview_stock)}{$theme_settings.show_preview_stock  = true}{/if}
    {if !isset($theme_settings.show_preview_stock_count)}{$theme_settings.show_preview_stock_count  = false}{/if}
    {if !isset($theme_settings.text_product_preorder)}{$theme_settings.text_product_preorder = false}{/if}
    {if !isset($theme_settings.show_product_rates)}{$theme_settings.show_product_rates = true}{/if}
    {if !isset($theme_settings.show_product_badge_saving)}{$theme_settings.show_product_badge_saving = false}{/if}
    {if !isset($theme_settings.show_product_discount)}{$theme_settings.show_product_discount = false}{/if}
    {if !isset($theme_settings.show_product_tile_sku)}{$theme_settings.show_product_tile_sku = false}{/if}
    {if !isset($theme_settings.zero_price_off_add2cart)}{$theme_settings.zero_price_off_add2cart = false}{/if}
    {if !isset($theme_settings.show_product_preview_video)}{$theme_settings.show_product_preview_video = true}{/if}
    {if $wa_app != 'shop' || !isset($theme_settings.product_preview_tile_gallerytile)}{$theme_settings.product_preview_tile_gallerytile = false}{/if}
    {if $wa_app != 'shop' || !isset($theme_settings.preview_product_images_lazy)}{$theme_settings.preview_product_images_lazy = false}{/if}
    {if !isset($theme_settings.text_price_zero)}
        {$theme_settings.text_price_zero = "Price on request"}
        {if $current_lang == 'ru_RU'}
            {$theme_settings.text_price_zero = "Цена по запросу"}
        {/if}
    {/if}
    {if !isset($theme_settings.text_product_none_stock)}{$theme_settings.text_product_none_stock = false}{/if}

    {if !isset($favorites)}
        {$favorites = $wa->cookie('favorites_list')}
        {if $favorites}{$favorites = ","|explode:$favorites}{else}{$favorites = []}{/if}
    {/if}

    {if $wa_app != 'shop' && $current_lang == 'ru_RU'}
        {$in_stock_text = "В наличии"}
        {$unit_text = "шт."}
        {$pre_order_only_text = "Под заказ"}
        {$none_stock_text = "Нет на складе"}
        {$vendor_code_text = "Артикул"}
    {/if}

    {$products = $wa->shop->productSet($list_id)}
    {if count($products)}
        {if !isset($theme_path) && empty($theme_path)}
            {$theme_path = $wa->shop->themePath('unishop')}
        {/if}
        <div class="js-preview-products products-tile products-tile--custom" data-retina="{$wa->shop->config('enable_2x')}" data-image-lazy="{$theme_settings.preview_product_images_lazy}">
            {foreach $products as $p}
                {include file="`$theme_path`product-preview-tile.html" product=$p theme_path=$theme_path}
            {/foreach}
        </div>
    {/if}
{/if}
{/strip}

