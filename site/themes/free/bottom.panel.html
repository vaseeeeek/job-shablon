{strip}
    <div class="MobileMenu">
        {if $theme_settings.header_top_links == 'site-pages'}
            {if $wa->site}{$_links = $wa->site->pages()}{/if}
        {elseif $theme_settings.header_top_links == 'shop-pages'}
            {if $wa->shop}{$_links = $wa->shop->pages()}{/if}
        {elseif $theme_settings.header_top_links == 'blog-pages'}
            {if $wa->blog}{$_links = $wa->blog->pages()}{/if}
        {elseif $theme_settings.header_top_links == 'photos-pages'}
            {if $wa->photos}{$_links = $wa->photos->pages()}{/if}
        {elseif $theme_settings.header_top_links == 'hub-pages'}
            {if $wa->hub}{$_links = $wa->hub->pages()}{/if}
        {elseif $theme_settings.header_top_links == 'app-menu'}
            {if $wa->menu && !empty($theme_settings.id_app_header-top_menu) && (int)$theme_settings.id_app_header-top_menu > 0}{$_links = $wa->menu->get($theme_settings.id_app_header-top_menu)}{/if}
        {elseif $theme_settings.header_top_links != 'none'}
            {$_links = $wa->apps()}
        {/if}
        <nav id="header_menu-nav" class="MobileMenu_nav-m">
            <div class="MobileMenu_nav-header--absolute">
                <div class="menu-close"><i class="fi-rr-cross-small"></i></div>
            </div>
            <h4>Категории</h4>
            {if $theme_settings.get_menu_from == 'app-menu'}
                {$categories = $wa->menu->get($theme_settings.id_app_menu_cat)}
            {else}
                {$categories = $wa->shop->categories(0, null, true, true)}
            {/if}
            {$cat_result = $categories}

            <div class="category-menu js-category-menu-wrap">
                {foreach $cat_result as $cat}
                    {$view_subcat = "one_column"}
                    {$_subcat = 0}
                    {if count($cat.childs) && $theme_settings.max_cat_lvl > 1}
                        {foreach $cat.childs as $child}
                            {$_subcat = 1}
                        {/foreach}
                    {/if}
                    {if $cat.id == 'else'}
                        {$_subcat = 1}
                    {/if}
                    <div class="menu-element {if $_subcat}js-cat-subs-{if $view_subcat == "one_column"}dropdown{else}disclosed{/if} has-subs{/if} cat-menu__item{if $theme_settings.cat_menu_dd_relative == "parent"} pos-rel {/if}">
                        {if $_subcat}
                            <i class="js-cat-item-caret fi-rr-angle-small-right"></i>
                        {/if}

                        {if $cat.id == 'else'}
                            <div class="cat-menu__item-link">
                                <span class="cat-menu__item-title cat-menu__item-title--else maincolor">
                                    [`Else categories`]
                                </span>
                            </div>
                        {else}
                            <a class="cat-menu__item-link" href="{$cat.url}">
                                <div class="cat-menu__item-title">
                                    {$cat.name}
                                </div>
                            </a>
                        {/if}
                        {if $_subcat}
                            {if isset($wa_parent_theme_path)}
                                {$subcatFile = "`$wa_parent_theme_path`/nav.`$view_subcat`.scat.html"}
                            {else}
                                {$subcatFile = "nav.`$view_subcat`.scat.html"}
                            {/if}
                            {include file=$subcatFile}
                        {/if}
                    </div>
                {/foreach}
            </div>
            {if count($_links) > 0}
                <h4>Информация</h4>
                <ul>
                    {foreach $_links as $link}
                        {if !($link.url == $wa_url && $link.name == $wa->accountName()) && !isset($link.top_menu_hide)}
                            {$is_select = strlen($link.url)>1 && $wa->currentUrl() == $link.url}
                            {$is_open = $link.url==$wa_app_url && !$wa->globals('isMyAccount') || strlen($link.url)>1 && $wa->currentUrl()|strstr:$link.url}
                            <li class="menu-element juniq-header-top-nav-el">
                                <a{if isset($link.target)} target="{$link.target}"{/if}{if $is_select} class="selected"{/if} href="{$link.url}">
                                    {$link.name}
                                </a>
                                {if isset($link.childs) && $link.childs && count($link.childs) && $theme_settings.display_header_top_menu_submenu}
                                    <i class="js-top-nav-caret nav-caret icon"></i>
                                    <div class="MobileMenu_nav-m-sub">
                                        <ul class="top-border-color">
                                            {foreach $link.childs as $child}
                                                {if !isset($child.top_menu_hide)}
                                                    <li>
                                                        <a{if isset($child.target)} target="{$child.target}"{/if} {if strlen($child.url)>1 && $wa->currentUrl() == $child.url} class="selected"{/if} href="{$child.url}">{$child.name}</a></li>
                                                {/if}
                                            {/foreach}
                                        </ul>
                                    </div>
                                {/if}
                            </li>
                        {/if}
                    {/foreach}
                </ul>
            {/if}
            <h4>Личный кабинет</h4>
            <div class="mob-menu-lk">
                <a class="menu-element" href="/my">
                    {if $wa->user()->isAuth()}
                        {$wa->user('firstname')|default:'[`My account`]'}
                    {else}
                        <span>Войти</span>
                    {/if}
                </a>
                {if shopAffiliate::isEnabled()}<a class="menu-element" href="/my/affiliate/">Партнерская программа</a>{/if}
            </div>

            {if $wa_app == 'shop' && $theme_settings.currency_toggle}
                {$currencies = $wa->shop->currencies()}
                {$currency = $wa->shop->currency()}
                {if count($currencies) > 1}
                    <div class="header_currency js-dd-outer">
                        {if count($currencies) > 1}
                            [`Currency`]:
                            <span data-id="currency-list" class="js-btnDrop-down currency_item free-icon-after">
                            {if !empty($theme_settings.show_currency_flag)}
                                <img src="{$wa_theme_url}img/currency/{$currency}.png" alt="{$currency}"/>
                            {/if}
                                {$currency}
                        </span>
                            <div id="currency-list" class="js-dd-wrap currency_list">
                                <div class="dd-wrap br-top-sdСolor">
                                    {foreach $currencies as $c_code => $c}
                                        <span data-value="{$c_code}"
                                              class="js-currency currency_item{if $c_code == $currency} maincolor{/if}">
                                    {if !empty($theme_settings.show_currency_flag)}
                                        <img src="{$wa_theme_url}img/currency/{$c_code}.png" alt="{$c_code}"/>
                                    {/if}
                                            {$c_code}
                                </span>
                                    {/foreach}
                                </div>
                            </div>
                            <script>
                                $(".js-currency").click(function () {
                                    var url = location.href;
                                    if (url.indexOf('?') == -1) {
                                        url += '?';
                                    } else {
                                        url += '&';
                                    }
                                    location.href = url + 'currency=' + $(this).data("value");
                                });
                            </script>
                        {/if}
                    </div>
                {/if}
            {/if}

            {if $wa_app == 'shop' && $theme_settings.language_toggle}
                <div class="header_lang">
                    <span class="header_lang-ttl">[`Language`]:</span>
                    {foreach waLocale::getAll('name') as $language => $lang_name}
                        {$language_text = $language|regex_replace:"/[a-z_]/":""}
                        {if $wa->locale() == $language}
                            <span class="header_lang-el">{$language_text}</span>
                        {else}
                            <a class="js-language header_lang-el" data-value="{$language}"
                               href="{$language}">{$language_text}</a>
                        {/if}
                    {/foreach}
                </div>
            {/if}
        </nav>
    </div>
    <div class="fixed-panel top-border-color js-fixed-panel">
        {if $theme_settings.fixed_panel_array}
            {$btns = ","|explode:$theme_settings.fixed_panel_array}
            {foreach $btns as $btn}
                {if $btn == 'burger'}
                    <i data-id="header_menu-nav" class="MobileMenu-btn icon fi-rr-menu-burger js-nav-button"></i>
                {/if}

                {if $btn == 'favorite'}
                    {if $theme_settings.favorites}
                        {$count_favorites = 0}
                        {$product_favor_arr = $wa->cookie('product_favor_arr')}
                        {if $product_favor_arr && $product_favor_arr != 'null'}
                            {$count_favorites = count(","|explode:$product_favor_arr)}
                        {/if}
                        <div class="js-favorites-preview product-custom">
                            <a class="js-products-link" href="{$wa->getUrl('shop/frontend/search')}?list=favorites">
                                <div class="product-custom_icon maincolor">
                                    <i class="fi-rr-heart icon"></i>
                                    <span class="js-products-count product-custom_short-count bg-sdСolor">{$count_favorites}</span>
                                </div>
                                {*                <div class="product-custom_content">*}
                                {*                    <span class="link product-custom_title">[`Favorites`]</span>*}
                                {*                </div>*}
                            </a>
                            <div class="product-msg-added-wrap js-product-added-msg">
                                <div class="product-added-msg br-top-sdСolor shadow">
                                    [`The product has been added to favorites`]
                                </div>
                            </div>
                        </div>
                    {/if}
                {/if}
                {if $btn == 'compare'}
                    {if $theme_settings.compare}
                        {$in_comparison = $wa->shop->inComparison()}
                        {$url = $wa->getUrl('shop/frontend/compare', ['id' => implode(',', $in_comparison)])}

                        {if $wa->cookie('shop_compare') == 'null' || !count($in_comparison)}
                            {$in_comparison = []}
                            {$url = $wa->getUrl('shop/frontend/compare')}
                        {/if}
                        <div class="js-preview-compare product-custom">
                            <a class="js-products-link" href="{$url}">
                                <div class="product-custom_icon maincolor">
                                    {literal}
                                        <svg version="1.1" id="svgCompareFixed" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                             viewBox="0 0 695 718" style="enable-background:new 0 0 695 718;width:20px" xml:space="preserve">
                                        <path d="M62,718H33c-18.2,0-33-14.8-33-33V220c0-18.2,14.8-33,33-33h29c18.2,0,33,14.8,33,33v465C95,703.2,80.2,718,62,718z"/>
                                            <path d="M362,717h-29c-18.2,0-33-14.8-33-33V33c0-18.2,14.8-33,33-33h29c18.2,0,33,14.8,33,33v651C395,702.2,380.2,717,362,717z"/>
                                            <path d="M662,717h-29c-18.2,0-33-14.8-33-33V429c0-18.2,14.8-33,33-33h29c18.2,0,33,14.8,33,33v255C695,702.2,680.2,717,662,717z"/>
                                    </svg>
                                    {/literal}
                                    <span class="js-products-count product-custom_short-count bg-sdСolor">{count($in_comparison)}</span>
                                </div>
                            </a>
                            <div class="product-msg-added-wrap js-product-added-msg">
                                <div class="product-added-msg br-top-sdСolor shadow">
                                    [`Product is added to compare`]
                                </div>
                            </div>
                        </div>
                    {/if}
                {/if}
                {if $btn == 'cart'}
                    {if method_exists($wa->shop, 'checkout')}
                        {$cartUrl = $wa->shop->checkout()->cartUrl()}
                    {else}
                        {$cartUrl = $wa->getUrl('shop/frontend/cart')}
                    {/if}
                    <div class="juniq-header-preview-cart preview-cart product-custom" data-url="{$cartUrl}">
                        <a href="{$cartUrl}">
                            {$cart_count = $wa->shop->cart->count()}
                            <div class="product-custom_icon maincolor">
                                <i class="fi-rr-shopping-cart icon"></i>
                                <span class="product-custom_short-count bg-sdСolor js-cart-preview-count">{$cart_count}</span>
                            </div>
                            {if !$wa->isMobile()}
                                <div class="product-custom_content">
                                    <span class="link product-custom_title ">[`Cart`]</span>
                                    <div class="js-cart-price-total-price product-custom_total">{wa_currency_html($wa->shop->cart->total(), $wa->shop->currency())}</div>
                                </div>
                            {/if}
                        </a>
                        <div class="product-msg-added-wrap product-msg-added-wrap--cart js-product-added-msg">
                            <div class="product-added-msg br-top-sdСolor shadow">
                                [`Product added to cart!`]
                            </div>
                        </div>
                    </div>
                {/if}
                {if $btn == 'filter' && $wa->param('action') == 'category'}
                    <div class="js-filter-fixed-btn product-custom">
                        <div class="product-custom_icon maincolor">
                            <i class="fi-rr-filter icon"></i>
                        </div>
                    </div>
                {/if}
                {if $btn == 'phone' && $theme_settings.header_company_phone}
                    <div class="product-custom">
                        <a class="product-custom_icon maincolor" href="tel:{$theme_settings.header_company_phone}">
                            {literal}
                            <svg version="1.1" id="svgPhone" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                 viewBox="0 0 54 53.4" style="enable-background:new 0 0 54 53.4;" xml:space="preserve">
                            <style type="text/css">
                                .product-custom .st0{fill:none;stroke:#111010;stroke-width:4;stroke-miterlimit:10;}
                                .product-custom .st1{fill:none;stroke:#111010;stroke-width:4;stroke-linecap:round;stroke-miterlimit:10;}
                            </style>
                                <path class="st0" d="M43.3,51.1c0,0,14.9-2,5.5-12.6c-0.7-0.8-1.6-1.6-2.3-2.4c-1.4-1.7-6.7-6.8-12.1,0c-0.2,0.3-0.6,0.5-1,0.3
                                c-2.7-1.3-13.2-6.9-16.2-15c-0.4-1.2-0.1-2.5,0.8-3.4c0.9-0.8,2-1.9,2.7-3c0.8-1.2,0.8-2.8,0-4C17.5,6.3,7.2-5.9,2.6,9.7
                                c-1.4,4.8-0.3,9.9,2.1,14.2c6.1,10.7,23.1,30.4,39,27.1"/>
                                <path class="st1" d="M31.5,13.6c0,0,5.4-0.8,9.8,9.7"/>
                                <path class="st1" d="M32.8,6.4c0,0,10.8,1.8,14.5,14.3"/>
                            </svg>
                            {/literal}
                            <style>
                                #svgPhone{
                                    width:25px;
                                }
                            </style>
                        </a>
                    </div>
                {/if}
            {/foreach}
        {else}
            <i data-id="header_menu-nav" class="MobileMenu-btn icon fi-rr-menu-burger js-nav-button"></i>
            {if $wa->param('action') == 'category'}
                <div class="js-filter-fixed-btn product-custom">
                    <div class="product-custom_icon maincolor">
                        <i class="fi-rr-filter icon"></i>
                    </div>
                </div>
            {/if}
        {/if}
    </div>
{/strip}